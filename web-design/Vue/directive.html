<!DOCTYPE html>
<html lang="Zh-cn">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>指令 | 谔定浣的熊</title>
    <meta name="generator" content="VuePress 1.6.0">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.bd98b8b6.css" as="style"><link rel="preload" href="/assets/js/app.f3f55258.js" as="script"><link rel="preload" href="/assets/js/2.37bd35fd.js" as="script"><link rel="preload" href="/assets/js/51.3fd01903.js" as="script"><link rel="prefetch" href="/assets/js/10.37f13515.js"><link rel="prefetch" href="/assets/js/11.465313c6.js"><link rel="prefetch" href="/assets/js/12.cf877ef4.js"><link rel="prefetch" href="/assets/js/13.94b5c286.js"><link rel="prefetch" href="/assets/js/14.8ccf3371.js"><link rel="prefetch" href="/assets/js/15.acc73f4d.js"><link rel="prefetch" href="/assets/js/16.62688db5.js"><link rel="prefetch" href="/assets/js/17.53aefb07.js"><link rel="prefetch" href="/assets/js/18.f440efb7.js"><link rel="prefetch" href="/assets/js/19.d770aa33.js"><link rel="prefetch" href="/assets/js/20.8421349d.js"><link rel="prefetch" href="/assets/js/21.1f690841.js"><link rel="prefetch" href="/assets/js/22.e5e93178.js"><link rel="prefetch" href="/assets/js/23.248c4131.js"><link rel="prefetch" href="/assets/js/24.8c43ff04.js"><link rel="prefetch" href="/assets/js/25.d3c5bc8e.js"><link rel="prefetch" href="/assets/js/26.54f1fb93.js"><link rel="prefetch" href="/assets/js/27.befa1ff5.js"><link rel="prefetch" href="/assets/js/28.fcce1c88.js"><link rel="prefetch" href="/assets/js/29.3016ddd4.js"><link rel="prefetch" href="/assets/js/3.a4c9e7fb.js"><link rel="prefetch" href="/assets/js/30.e92bb65d.js"><link rel="prefetch" href="/assets/js/31.74a34bd9.js"><link rel="prefetch" href="/assets/js/32.6caa0ec1.js"><link rel="prefetch" href="/assets/js/33.5653b692.js"><link rel="prefetch" href="/assets/js/34.0801d579.js"><link rel="prefetch" href="/assets/js/35.24c47487.js"><link rel="prefetch" href="/assets/js/36.654f2eab.js"><link rel="prefetch" href="/assets/js/37.851b8ab7.js"><link rel="prefetch" href="/assets/js/38.e4bef3df.js"><link rel="prefetch" href="/assets/js/39.593d37fd.js"><link rel="prefetch" href="/assets/js/4.4deef9ed.js"><link rel="prefetch" href="/assets/js/40.15675e92.js"><link rel="prefetch" href="/assets/js/41.fd599228.js"><link rel="prefetch" href="/assets/js/42.b24f1c19.js"><link rel="prefetch" href="/assets/js/43.2eb246c0.js"><link rel="prefetch" href="/assets/js/44.2cfa054e.js"><link rel="prefetch" href="/assets/js/45.822978f3.js"><link rel="prefetch" href="/assets/js/46.1d3e5256.js"><link rel="prefetch" href="/assets/js/47.18d6e8ee.js"><link rel="prefetch" href="/assets/js/48.94462d6b.js"><link rel="prefetch" href="/assets/js/49.58b919a8.js"><link rel="prefetch" href="/assets/js/5.28ad6baf.js"><link rel="prefetch" href="/assets/js/50.bb717a59.js"><link rel="prefetch" href="/assets/js/6.e416f727.js"><link rel="prefetch" href="/assets/js/7.62ba56a4.js"><link rel="prefetch" href="/assets/js/8.38e3313d.js"><link rel="prefetch" href="/assets/js/9.95f36535.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bd98b8b6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/hero.png" alt="谔定浣的熊" class="logo"> <span class="site-name can-hide">谔定浣的熊</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/web-design/" class="nav-link router-link-active">
  高级前端养成攻略
</a></div><div class="nav-item"><a href="/CG/" class="nav-link">
  算法（todo）
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于我" class="dropdown-title"><span class="title">关于我</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于我" class="mobile-dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  没想好放什么
</a></li><li class="dropdown-item"><!----> <a href="/web-design/" class="nav-link router-link-active">
  先占个位以免忘记
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/web-design/" class="nav-link router-link-active">
  高级前端养成攻略
</a></div><div class="nav-item"><a href="/CG/" class="nav-link">
  算法（todo）
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于我" class="dropdown-title"><span class="title">关于我</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于我" class="mobile-dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  没想好放什么
</a></li><li class="dropdown-item"><!----> <a href="/web-design/" class="nav-link router-link-active">
  先占个位以免忘记
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/web-design/" aria-current="page" class="sidebar-link">简介</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Html5</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS3</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Jquery</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Browser</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Es6</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Angularjs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web-design/Vue/basis.html" class="sidebar-link">基础</a></li><li><a href="/web-design/Vue/component.html" class="sidebar-link">组件</a></li><li><a href="/web-design/Vue/directive.html" aria-current="page" class="active sidebar-link">指令</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Less/Stylus</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>代码库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他问题</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#内置指令">内置指令</a></li><li><a href="#自定义指令">自定义指令</a></li></ul></div>
指令是带有特殊前缀&quot;v-&quot;的HTML特性，它绑定一个表达式，并将一些特性用在DOM上。<p></p> <h3 id="内置指令"><a href="#内置指令" class="header-anchor">#</a> 内置指令</h3> <h5 id="v-bind"><a href="#v-bind" class="header-anchor">#</a> v-bind</h5> <p>v-bind主要用法是动态更新HTML元素上的属性。常见的比如class及style。
绑定class的方式</p> <ul><li>v-bind:class设置一个对象，可以动态切换class.如：</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code>...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{<span class="token punctuation">'</span>active<span class="token punctuation">'</span> : isActive}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     el <span class="token operator">:</span> <span class="token string">&quot;#app&quot;</span><span class="token punctuation">,</span>
     data <span class="token operator">:</span> <span class="token punctuation">{</span>
        isActive <span class="token operator">:</span> <span class="token boolean">true</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>当条件过长或者逻辑复杂可以绑定在计算属性上。</p> <ul><li>数组语法</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[activeCls, errorCls]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
var app = new Vue({
    el : &quot;#app&quot;,
    data : {
        activeCls : &quot;active&quot;,
        errorCls : &quot;error&quot;
    }
})
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>数组中可使用三元表达式切换class，也可在其中使用对象语法。
绑定内联样式v-bind:style，与class类似，也有对象语法和数组语法，
在组件上写class :class或者style :style时,规则会直接应用到这个组件的根元素上。</p> <h5 id="v-cloak"><a href="#v-cloak" class="header-anchor">#</a> v-cloak</h5> <p>v-cloak不需要表达式，会在Vue实例结束编译时从绑定的HTML元素上移除，通常和css display:none配合使用。在网速较慢，Vue.js文件未加载玩是，页面可能会出现<code>{ { message } }</code>的字样，直接Vue创建实例编译模板，DOM才会替换，屏幕在这个过程会有闪动。
v-cloak是一个解决初始化慢导致页面闪动的最佳实践，对于简单项目有用，但对于复杂项目，例如结合webpack使用时，html结构只有一个空div元素，内容由挂载不同组件完成，故不需要使用。</p> <h5 id="v-once"><a href="#v-once" class="header-anchor">#</a> v-once</h5> <p>不需要表达式，定义它的元素或组件只渲染一次，包括元素或组件的所有子节点，首次渲染后不在随数据的变化重新渲染，将被视为静态内容。</p> <h5 id="v-if、v-else-if、v-else"><a href="#v-if、v-else-if、v-else" class="header-anchor">#</a> v-if、v-else-if、v-else</h5> <p>v-else-if要紧跟v-if，v-else要紧跟v-else-if或v-if,表达式为真时当前元素/组件及子节点将被渲染，为假时移除。如果一次判断多个元素可以在Vue内置<code>&lt;template&gt;</code>元素上使用条件指令，最终渲染时不包括改元素。
Vue在渲染元素时，处于效率考虑，会尽可能复用已有的元素而非重新渲染。比如Input元素，使用v-if v-else时，DOM虽然在切换时变了，但是之前输入框的内容并不会变，只会替换placeholder的内容。可以使用Vue提供的key属性，它可以决定是否要复用元素，key的值必须唯一。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
<span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;type === 'name'&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>label<span class="token operator">&gt;</span>用户名<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>input placeholder<span class="token operator">=</span><span class="token string">&quot;输入用户名&quot;</span> key<span class="token operator">=</span><span class="token string">&quot;name-input&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>label<span class="token operator">&gt;</span>邮箱<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>input placeholder<span class="token operator">=</span><span class="token string">&quot;输入邮箱&quot;</span> key<span class="token operator">=</span><span class="token string">&quot;mail-input&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre></div><p>这里input不会在复用，切换时输入内容也会删除，但label还是会被复用。</p> <h5 id="v-show"><a href="#v-show" class="header-anchor">#</a> v-show</h5> <p>v-show是改变元素css属性display,当切换频繁时使用，但不能用在v-template上。</p> <h5 id="v-for"><a href="#v-for" class="header-anchor">#</a> v-for</h5> <ul><li>数组遍历：表达式结合in使用，比如<code>v-for=&quot;book in books&quot;</code>。列表渲染也支持使用of替代in。
<code>v-for=&quot;(book, index) in books&quot;</code>，第二项就是books当前项的索引。</li> <li>对象遍历: <code>v-for=&quot;value in user&quot;</code>。遍历对象有两个可选参数，分别是键名和索引<code>v-for=&quot;(value, key, index) in user&quot;</code></li> <li>v-for还可以迭代整数 <code>v-for=&quot;n in 10&quot;</code>
v-for也可用在内置标签<code>&lt;template&gt;</code>上，对于将多个元素进行渲染。
Vue的核心是数据与视图的双向绑定，当我们修改数组时，Vue会检测到数据变化，所以用v-for渲染的视图也会立即更新。使用这些方法改变数组会触发视图更新：push、pop、shift、unshift、splice、sort、reverse。在使用fiter、concat、slice、map等时不会替换原数组。
注意:slice返回一个新数组，不过是浅拷贝。
Vue在检测到数组变化时，并不是直接重新渲染整个列表，而是最大化的复用DOM元素，替换的数组中，含有相同元素的项不会被重新渲染。但是Vue不能检测到通过索引直接设置项和修改数组长度引起的数组变化，即不会触发视图更新。
<code>app.books[3] = {...} app.books.length = 1</code>
如果必须要这样使用可以这样解决,对于直接设置项</li></ul> <ol><li>使用Vue内置的set方法</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>books<span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">,</span> <span class="token punctuation">{</span>
    name <span class="token operator">:</span> <span class="token string">&quot;RORONOA&quot;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>2.如果在webpack中使用组件化方式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$set</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>books<span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">,</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;CHOPPER&quot;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>这里this指向当前组件实例，即app。在非webpack模式下也可以用$set方法。比如app.$set(...).也可使用splice。</p> <h5 id="v-model"><a href="#v-model" class="header-anchor">#</a> v-model</h5> <h3 id="自定义指令"><a href="#自定义指令" class="header-anchor">#</a> 自定义指令</h3> <h5 id="注册方法"><a href="#注册方法" class="header-anchor">#</a> 注册方法</h5> <ul><li>全局注册 Vue.directive(&quot;focus&quot;, {//指令选项})</li> <li>局部注册</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    el <span class="token operator">:</span> <span class="token string">&quot;#app&quot;</span><span class="token punctuation">,</span>
    directives <span class="token operator">:</span> <span class="token punctuation">{</span>
        focus <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">//指令选项</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>写法与组件类似，只是方法名由component改为directive。</p> <h6 id="自定义指令选项"><a href="#自定义指令选项" class="header-anchor">#</a> 自定义指令选项</h6> <p>自定义指令的选项是由几个钩子函数组成的，每个都是可选的。</p> <ul><li>bind : 只调用一次，指令第一次绑定到元素时调用，用这个钩子函数可以定义一个在绑定时执行一次的初始化动作。</li> <li>inserted : 被绑定元素插入父节点时调用(父节点存在时即可调用,不必存在于document中)。</li> <li>update : 被绑定元素所在的模板更新时调用，而不论绑定值是否变化。通过比较更新前后的绑定值，可以忽略不必要的模板更新。</li> <li>componentUpdated : 被绑定元素所在模板完成一次更新周期时调用。</li> <li>unbind ： 只调用一次，指令与元素解绑时调用。
每个钩子函数都有几个参数可用，</li> <li>el : 指令所绑定的元素，可以用来直接操作DOM</li> <li>binding ： 一个对象</li> <li>vnode : Vue编译生成的虚拟节点</li> <li>oldVnode : 上一个虚拟节点，仅在update和componentUpdate钩子中可用</li></ul> <p>大多数使用场景，会在bind钩子里绑定一些事件,比如document上用addEventListener绑定，在unbind里用removeEventListener解绑。</p> <h6 id="binding属性"><a href="#binding属性" class="header-anchor">#</a> binding属性</h6> <ul><li>name 指令名称，不包含v-前缀</li> <li>value 指令的绑定值，例如v-my-directive=&quot;1+1&quot;,value的值是2.若为一个函数可直接使用binding.value()调用。</li> <li>oldValue 指令绑定的前一个值，仅在update和componentUpdated钩子中可用。无论值是否改变都可用。</li> <li>expression 绑定值的字符串形式。例如v-my-direcrive=&quot;1+1&quot;,expression的值是&quot;1+1&quot;.</li> <li>arg 传给指令的参数。例如v-my-directive:foo，arg的值是foo。</li> <li>modifiers 一个包含修饰符的对象。例如v-my-directive.foo.bar，修饰符对象modifiers的值{foo:true,bar:true}.</li> <li>如果需要多个值，自定义指令也可传入一个javascript对象。</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web-design/Vue/component.html" class="prev">
        组件
      </a></span> <span class="next"><a href="/web-design/Design patterns/observer.html">
        观察者模式
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f3f55258.js" defer></script><script src="/assets/js/2.37bd35fd.js" defer></script><script src="/assets/js/51.3fd01903.js" defer></script>
  </body>
</html>
